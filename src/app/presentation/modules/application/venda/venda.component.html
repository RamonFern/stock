<div class="buttons" *ngIf="botoes">
  <div class="tabs__nav-bar" #navbar (click)="criarVenda()">
    <a  class="tab-label mat-elevation-z8">
      <mat-icon class="nav__icon">
        sell
      </mat-icon>
      <span class="headline-4 tab-label__title">Vender</span>
    </a>
  </div>
  <div class="tabs__nav-bar" #navbar>
    <a  class="tab-label mat-elevation-z8">
      <mat-icon class="nav__icon">
        sell
      </mat-icon>
      <span class="headline-4 tab-label__title">Simular Venda</span>
    </a>
  </div>
</div>

<div *ngIf="!botoes">
  <div class="header">
    <span class="headline-4">Caixa - ABERTO</span>
  </div>
  <div class="main__principal">
    <div class="header__sub">
      <div class="sub" *ngIf="clickedRows.length">
        <span class="headline-4">NOTA</span>
      </div>
      <div class="sub-meio" *ngIf="finalizar">
        <span class="headline-4">PRODUTO</span>
      </div>
      <div class="sub">
        <span class="headline-4">TOTAL</span>
      </div>
    </div>
    <div class="todo">
      <div class="esq" *ngIf="clickedRows.length">
        <div class="esq__inter">
          NOTA
          <div class="esq__inter-header">
            <span class="body-2 cor-font">cod</span>
            <span class="body-2 cor-font">Nome</span>
            <span class="body-2 cor-font">unidade</span>
            <span class="body-2 cor-font">qtd</span>
            <span class="body-2 cor-font">total</span>
        </div>
          <div class="esq__inter-header" *ngFor="let item of clickedRows">
            <span>{{item.idProduto}}</span>
            <span>{{item.nomeproduto}}</span>
            <span>{{item.valorunidade}}</span>
            <span>{{item.quantidade}}</span>
            <span>{{item.total}}</span>
          </div>
          <div>
            <button mat-stroked-button (click)="finalizarCancelarVenda()" color="primary" *ngIf="finalizar">Finalizar</button>
            <button mat-stroked-button (click)="finalizarCancelarVenda()" color="warn" *ngIf="!finalizar">Adicionar produto</button>
          </div>
        </div>

      </div>
      <div class="meio" *ngIf="finalizar">
        <div class="meio__main">
          <form [formGroup]="formPesquisa" class="mat-elevation-z2 field" *ngIf="!produto || produto?.id === 0">
            <!-- <mat-form-field appearance="outline" class="form-field" *ngIf="!produto"> -->
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Buscar produto</mat-label>
              <div class="input-pesquisa">
                <input matInput type="text" name="pesquisa" formControlName="pesquisa" (keyup)="applyFilter($event)" placeholder="Ex. arroz" #input>
                <mat-icon>
                  <span class="material-symbols-outlined">
                    search
                  </span>
                </mat-icon>
              </div>
            </mat-form-field>
            <!-- <button mat-stroked-button color="warn" (click)="clearInput()">Limpar</button> -->
          </form>

          <!-- <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 table" *ngIf="dataSource.filter.length && !produto"> -->
          <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 table" *ngIf="dataSource.filter.length && !produto || produto?.id === 0">
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef> Cod </th>
              <td mat-cell *matCellDef="let element"> {{element.id}} </td>
            </ng-container>

            <ng-container matColumnDef="nome">
              <th mat-header-cell *matHeaderCellDef> Nome </th>
              <td mat-cell *matCellDef="let element"> {{element.nome}} </td>
            </ng-container>

            <ng-container matColumnDef="marca">
              <th mat-header-cell *matHeaderCellDef> Marca </th>
              <td mat-cell *matCellDef="let element"> {{element.marca}} </td>
            </ng-container>

            <ng-container matColumnDef="qntdEstoque">
              <th mat-header-cell *matHeaderCellDef> Quantidade </th>
              <td mat-cell *matCellDef="let element"> {{element.qntdEstoque}} </td>
            </ng-container>

            <ng-container matColumnDef="valor">
              <th mat-header-cell *matHeaderCellDef> Valor </th>
              <td mat-cell *matCellDef="let element"> {{element.valor | currency: 'BRL':'symbol'}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr
            mat-row
            (click)="addProdutoNaNota(row)"
            *matRowDef="let row; columns: displayedColumns;"
            ></tr>
            <!-- <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr> -->

            <tr class="mat-row" *matNoDataRow>
              <!-- <td class="mat-cell" colspan="5">Não foi encontrado o produto "{{input.value}}"</td> -->
              <td class="mat-cell" colspan="5">Não foi encontrado o produto!</td>
            </tr>
          </table>

          <!-- <form [formGroup]="form" *ngIf="produto"> -->
          <form [formGroup]="form" *ngIf="produto && produto?.id !== 0">
            <div class="meio__input">
              <mat-label>COD PRODUTO</mat-label>
              <mat-form-field appearance="outline">
                <input matInput type="number" name="id" formControlName="id" required />
              </mat-form-field>
              <mat-label>DESCRIÇÃO DO PRODUTO</mat-label>
              <mat-form-field appearance="outline">
                <input matInput type="text" name="descricao" formControlName="descricao" required />
              </mat-form-field>
              <mat-label>QUANTIDADE</mat-label>
              <mat-form-field appearance="outline">
                <input matInput type="number" name="quantidade" formControlName="quantidade" required />
              </mat-form-field>
              <mat-label>PREÇO UNITÁRIO</mat-label>
              <mat-form-field appearance="outline">
                <input matInput type="number" name="preco" formControlName="preco" required />
              </mat-form-field>
              <mat-label>TOTAL</mat-label>
              <mat-form-field appearance="outline">
                <input matInput type="number" name="total" formControlName="total" required />
              </mat-form-field>
            </div>
            <div class="example-button-row">
              <!-- <button mat-fab class="add-button"  color="primary">
                <mat-icon>done</mat-icon>
                adicionar na nota
              </button> -->
              <button mat-raised-button (click)="enviarParaNota()">
                <mat-icon>done</mat-icon>
                adicionar na nota
              </button>

              <button mat-raised-button (click)="zerarProduto()" color="accent">
                <mat-icon>close</mat-icon>
                remover
              </button>
              <!-- <button mat-fab class="add-button" (click)="zerarProduto()" extended color="warn">
                <mat-icon>close</mat-icon>
                remover
              </button> -->
            </div>
          </form>
        </div>
        <!-- <ul>
          <li *ngFor="let clickedRow of clickedRows">
            Clicked on {{clickedRow.nome}}
          </li>
        </ul> -->
      </div>
      <div class="dir">
        <form [formGroup]="formTotais" class="dir__main">
          <mat-form-field appearance="outline" class="mat-form">
            <input matInput type="number" name="totalGeral" formControlName="totalGeral" required />
          </mat-form-field>
          <div class="totais">
            <span class="headline-4">DESCONTO</span>
          </div>
          <mat-form-field appearance="outline" class="mat-form">
            <input matInput type="number" name="desconto" formControlName="desconto"  required />
          </mat-form-field>
          <div class="totais">
            <span class="headline-4">SUB-TOTAL</span>
          </div>
          <mat-form-field appearance="outline" class="mat-form">
            <input matInput type="number" name="subtotal" formControlName="subtotal" required />
          </mat-form-field>
          <div class="totais">
            <span class="headline-4">VALOR RECEBIDO</span>
          </div>
          <mat-form-field appearance="outline" class="mat-form">
            <input matInput type="number" name="valorRecebido" formControlName="valorRecebido" required />
          </mat-form-field>
          <div class="totais">
            <span class="headline-4">TROCO</span>
          </div>
          <mat-form-field appearance="outline" class="mat-form">
            <input matInput type="number" name="troco" formControlName="troco" required />
          </mat-form-field>
        </form>
      </div>
    </div>

  </div>
</div>
